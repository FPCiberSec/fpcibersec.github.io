{"version":3,"file":"atropos.js.map","sources":["../src/atropos.js"],"sourcesContent":["/* eslint-disable no-restricted-globals */\nconst $ = (el, sel) => el.querySelector(sel);\nconst $$ = (el, sel) => el.querySelectorAll(sel);\n\nconst removeUndefinedProps = (obj = {}) => {\n  const result = {};\n  Object.keys(obj).forEach((key) => {\n    if (typeof obj[key] !== 'undefined') result[key] = obj[key];\n  });\n  return result;\n};\n\nfunction Atropos(originalParams = {}) {\n  let { el, eventsEl } = originalParams;\n\n  const self = {\n    __atropos__: true,\n    params: {\n      alwaysActive: false,\n      activeOffset: 50,\n      shadowOffset: 50,\n      shadowScale: 1,\n      duration: 300,\n      rotate: true,\n      rotateTouch: true,\n      rotateXMax: 15,\n      rotateYMax: 15,\n      rotateXInvert: false,\n      rotateYInvert: false,\n      stretchX: 0,\n      stretchY: 0,\n      stretchZ: 0,\n      commonOrigin: true,\n      shadow: true,\n      highlight: true,\n      onEnter: null,\n      onLeave: null,\n      onRotate: null,\n      ...removeUndefinedProps(originalParams || {}),\n    },\n    destroyed: false,\n    isActive: false,\n  };\n\n  const { params } = self;\n\n  let rotateEl;\n  let scaleEl;\n  let innerEl;\n\n  let elBoundingClientRect;\n  let eventsElBoundingClientRect;\n\n  let shadowEl;\n  let highlightEl;\n\n  let isScrolling;\n  let clientXStart;\n  let clientYStart;\n\n  const queue = [];\n  let queueFrameId;\n  const purgeQueue = () => {\n    queueFrameId = requestAnimationFrame(() => {\n      queue.forEach((data) => {\n        if (typeof data === 'function') {\n          data();\n        } else {\n          const { element, prop, value } = data;\n          element.style[prop] = value;\n        }\n      });\n      queue.splice(0, queue.length);\n      purgeQueue();\n    });\n  };\n  purgeQueue();\n\n  const $setDuration = (element, value) => {\n    queue.push({ element, prop: 'transitionDuration', value });\n  };\n  const $setEasing = (element, value) => {\n    queue.push({ element, prop: 'transitionTimingFunction', value });\n  };\n  const $setTransform = (element, value) => {\n    queue.push({ element, prop: 'transform', value });\n  };\n  const $setOpacity = (element, value) => {\n    queue.push({ element, prop: 'opacity', value });\n  };\n  const $setOrigin = (element, value) => {\n    queue.push({ element, prop: 'transformOrigin', value });\n  };\n  const $on = (element, event, handler, props) => element.addEventListener(event, handler, props);\n  const $off = (element, event, handler, props) =>\n    element.removeEventListener(event, handler, props);\n\n  const createShadow = () => {\n    let created;\n    shadowEl = $(el, '.atropos-shadow');\n    if (!shadowEl) {\n      shadowEl = document.createElement('span');\n      shadowEl.classList.add('atropos-shadow');\n      created = true;\n    }\n    $setTransform(\n      shadowEl,\n      `translate3d(0,0,-${params.shadowOffset}px) scale(${params.shadowScale})`,\n    );\n    if (created) {\n      rotateEl.appendChild(shadowEl);\n    }\n  };\n  const createHighlight = () => {\n    let created;\n    highlightEl = $(el, '.atropos-highlight');\n    if (!highlightEl) {\n      highlightEl = document.createElement('span');\n      highlightEl.classList.add('atropos-highlight');\n      created = true;\n    }\n\n    $setTransform(highlightEl, `translate3d(0,0,0)`);\n    if (created) {\n      innerEl.appendChild(highlightEl);\n    }\n  };\n\n  const setChildrenOffset = ({\n    rotateXPercentage = 0,\n    rotateYPercentage = 0,\n    duration,\n    opacityOnly,\n    easeOut,\n  }) => {\n    const getOpacity = (element) => {\n      if (element.dataset.atroposOpacity && typeof element.dataset.atroposOpacity === 'string') {\n        return element.dataset.atroposOpacity.split(';').map((v) => parseFloat(v));\n      }\n      return undefined;\n    };\n    $$(el, '[data-atropos-offset], [data-atropos-opacity]').forEach((childEl) => {\n      $setDuration(childEl, duration);\n      $setEasing(childEl, easeOut ? 'ease-out' : '');\n      const elementOpacity = getOpacity(childEl);\n      if (rotateXPercentage === 0 && rotateYPercentage === 0) {\n        if (!opacityOnly) $setTransform(childEl, `translate3d(0, 0, 0)`);\n        if (elementOpacity) $setOpacity(childEl, elementOpacity[0]);\n      } else {\n        const childElOffset = parseFloat(childEl.dataset.atroposOffset) / 100;\n        if (!Number.isNaN(childElOffset) && !opacityOnly) {\n          $setTransform(\n            childEl,\n            `translate3d(${-rotateYPercentage * -childElOffset}%, ${\n              rotateXPercentage * -childElOffset\n            }%, 0)`,\n          );\n        }\n        if (elementOpacity) {\n          const [min, max] = elementOpacity;\n          const rotatePercentage = Math.max(\n            Math.abs(rotateXPercentage),\n            Math.abs(rotateYPercentage),\n          );\n          $setOpacity(childEl, min + ((max - min) * rotatePercentage) / 100);\n        }\n      }\n    });\n  };\n\n  const setElements = (clientX, clientY) => {\n    const isMultiple = el !== eventsEl;\n    if (!elBoundingClientRect) {\n      elBoundingClientRect = el.getBoundingClientRect();\n    }\n    if (isMultiple && !eventsElBoundingClientRect) {\n      eventsElBoundingClientRect = eventsEl.getBoundingClientRect();\n    }\n    if (typeof clientX === 'undefined' && typeof clientY === 'undefined') {\n      const rect = isMultiple ? eventsElBoundingClientRect : elBoundingClientRect;\n      clientX = rect.left + rect.width / 2;\n      clientY = rect.top + rect.height / 2;\n    }\n\n    let rotateX = 0;\n    let rotateY = 0;\n    const { top, left, width, height } = elBoundingClientRect;\n    let transformOrigin;\n    if (!isMultiple) {\n      const centerX = width / 2;\n      const centerY = height / 2;\n\n      const coordX = clientX - left;\n      const coordY = clientY - top;\n\n      rotateY = ((params.rotateYMax * (coordX - centerX)) / (width / 2)) * -1;\n      rotateX = (params.rotateXMax * (coordY - centerY)) / (height / 2);\n    } else {\n      const {\n        top: parentTop,\n        left: parentLeft,\n        width: parentWidth,\n        height: parentHeight,\n      } = eventsElBoundingClientRect;\n      const offsetLeft = left - parentLeft;\n      const offsetTop = top - parentTop;\n\n      const centerX = width / 2 + offsetLeft;\n      const centerY = height / 2 + offsetTop;\n\n      const coordX = clientX - parentLeft;\n      const coordY = clientY - parentTop;\n\n      rotateY = ((params.rotateYMax * (coordX - centerX)) / (parentWidth - width / 2)) * -1;\n      rotateX = (params.rotateXMax * (coordY - centerY)) / (parentHeight - height / 2);\n      transformOrigin = `${clientX - left}px ${clientY - top}px`;\n    }\n\n    rotateX = Math.min(Math.max(-rotateX, -params.rotateXMax), params.rotateXMax);\n    if (params.rotateXInvert) rotateX = -rotateX;\n    rotateY = Math.min(Math.max(-rotateY, -params.rotateYMax), params.rotateYMax);\n    if (params.rotateYInvert) rotateY = -rotateY;\n\n    const rotateXPercentage = (rotateX / params.rotateXMax) * 100;\n    const rotateYPercentage = (rotateY / params.rotateYMax) * 100;\n\n    const stretchX =\n      (isMultiple ? (rotateYPercentage / 100) * params.stretchX : 0) *\n      (params.rotateYInvert ? -1 : 1);\n    const stretchY =\n      (isMultiple ? (rotateXPercentage / 100) * params.stretchY : 0) *\n      (params.rotateXInvert ? -1 : 1);\n    const stretchZ = isMultiple\n      ? (Math.max(Math.abs(rotateXPercentage), Math.abs(rotateYPercentage)) / 100) * params.stretchZ\n      : 0;\n    $setTransform(\n      rotateEl,\n      `translate3d(${stretchX}%, ${-stretchY}%, ${-stretchZ}px) rotateX(${rotateX}deg) rotateY(${rotateY}deg)`,\n    );\n    if (transformOrigin && params.commonOrigin) {\n      $setOrigin(rotateEl, transformOrigin);\n    }\n\n    if (highlightEl) {\n      $setDuration(highlightEl, `${params.duration}ms`);\n      $setEasing(highlightEl, 'ease-out');\n      $setTransform(\n        highlightEl,\n        `translate3d(${-rotateYPercentage * 0.25}%, ${rotateXPercentage * 0.25}%, 0)`,\n      );\n      $setOpacity(\n        highlightEl,\n        Math.max(Math.abs(rotateXPercentage), Math.abs(rotateYPercentage)) / 100,\n      );\n    }\n\n    setChildrenOffset({\n      rotateXPercentage,\n      rotateYPercentage,\n      duration: `${params.duration}ms`,\n      easeOut: true,\n    });\n\n    if (typeof params.onRotate === 'function') params.onRotate(rotateX, rotateY);\n  };\n\n  const activate = () => {\n    queue.push(() => el.classList.add('atropos-active'));\n    $setDuration(rotateEl, `${params.duration}ms`);\n    $setEasing(rotateEl, 'ease-out');\n    $setTransform(scaleEl, `translate3d(0,0, ${params.activeOffset}px)`);\n    $setDuration(scaleEl, `${params.duration}ms`);\n    $setEasing(scaleEl, 'ease-out');\n    if (shadowEl) {\n      $setDuration(shadowEl, `${params.duration}ms`);\n      $setEasing(shadowEl, 'ease-out');\n    }\n\n    self.isActive = true;\n  };\n\n  const onPointerEnter = (e) => {\n    isScrolling = undefined;\n    if (e.type === 'pointerdown' && e.pointerType === 'mouse') return;\n    if (e.type === 'pointerenter' && e.pointerType !== 'mouse') return;\n    if (e.type === 'pointerdown') {\n      e.preventDefault();\n    }\n    clientXStart = e.clientX;\n    clientYStart = e.clientY;\n\n    if (params.alwaysActive) {\n      elBoundingClientRect = undefined;\n      eventsElBoundingClientRect = undefined;\n      return;\n    }\n    activate();\n    if (typeof params.onEnter === 'function') params.onEnter();\n  };\n\n  const onTouchMove = (e) => {\n    if (isScrolling === false && e.cancelable) {\n      e.preventDefault();\n    }\n  };\n\n  const onPointerMove = (e) => {\n    if (!params.rotate || !self.isActive) return;\n    if (e.pointerType !== 'mouse') {\n      if (!params.rotateTouch) return;\n      e.preventDefault();\n    }\n    const { clientX, clientY } = e;\n\n    const diffX = clientX - clientXStart;\n    const diffY = clientY - clientYStart;\n    if (\n      typeof params.rotateTouch === 'string' &&\n      (diffX !== 0 || diffY !== 0) &&\n      typeof isScrolling === 'undefined'\n    ) {\n      if (diffX * diffX + diffY * diffY >= 25) {\n        const touchAngle = (Math.atan2(Math.abs(diffY), Math.abs(diffX)) * 180) / Math.PI;\n        isScrolling = params.rotateTouch === 'scroll-y' ? touchAngle > 45 : 90 - touchAngle > 45;\n      }\n      if (isScrolling === false) {\n        el.classList.add('atropos-rotate-touch');\n        if (e.cancelable) {\n          e.preventDefault();\n        }\n      }\n    }\n    if (e.pointerType !== 'mouse' && isScrolling) {\n      return;\n    }\n    setElements(clientX, clientY);\n  };\n\n  const onPointerLeave = (e) => {\n    elBoundingClientRect = undefined;\n    eventsElBoundingClientRect = undefined;\n    if (!self.isActive) return;\n    if (e && e.type === 'pointerup' && e.pointerType === 'mouse') return;\n    if (e && e.type === 'pointerleave' && e.pointerType !== 'mouse') return;\n    if (typeof params.rotateTouch === 'string' && isScrolling) {\n      el.classList.remove('atropos-rotate-touch');\n    }\n\n    if (params.alwaysActive) {\n      setElements();\n      if (typeof params.onRotate === 'function') params.onRotate(0, 0);\n      if (typeof params.onLeave === 'function') params.onLeave();\n      return;\n    }\n\n    queue.push(() => el.classList.remove('atropos-active'));\n    $setDuration(scaleEl, `${params.duration}ms`);\n    $setEasing(scaleEl, '');\n    $setTransform(scaleEl, `translate3d(0,0, ${0}px)`);\n    if (shadowEl) {\n      $setDuration(shadowEl, `${params.duration}ms`);\n      $setEasing(shadowEl, '');\n    }\n    if (highlightEl) {\n      $setDuration(highlightEl, `${params.duration}ms`);\n      $setEasing(highlightEl, '');\n      $setTransform(highlightEl, `translate3d(0, 0, 0)`);\n      $setOpacity(highlightEl, 0);\n    }\n    $setDuration(rotateEl, `${params.duration}ms`);\n    $setEasing(rotateEl, '');\n    $setTransform(rotateEl, `translate3d(0,0,0) rotateX(0deg) rotateY(0deg)`);\n\n    setChildrenOffset({ duration: `${params.duration}ms` });\n\n    self.isActive = false;\n    if (typeof params.onRotate === 'function') params.onRotate(0, 0);\n    if (typeof params.onLeave === 'function') params.onLeave();\n  };\n\n  const onDocumentClick = (e) => {\n    const clickTarget = e.target;\n    if (!eventsEl.contains(clickTarget) && clickTarget !== eventsEl && self.isActive) {\n      onPointerLeave();\n    }\n  };\n\n  const initDOM = () => {\n    if (typeof el === 'string') {\n      el = $(document, el);\n    }\n    if (!el) return;\n\n    // eslint-disable-next-line\n    if (el.__atropos__) return;\n\n    if (typeof eventsEl !== 'undefined') {\n      if (typeof eventsEl === 'string') {\n        eventsEl = $(document, eventsEl);\n      }\n    } else {\n      eventsEl = el;\n    }\n\n    Object.assign(self, {\n      el,\n    });\n\n    rotateEl = $(el, '.atropos-rotate');\n    scaleEl = $(el, '.atropos-scale');\n    innerEl = $(el, '.atropos-inner');\n\n    // eslint-disable-next-line\n    el.__atropos__ = self;\n  };\n\n  const init = () => {\n    initDOM();\n    if (!el || !eventsEl) return;\n    if (params.shadow) {\n      createShadow();\n    }\n    if (params.highlight) {\n      createHighlight();\n    }\n    if (params.rotateTouch) {\n      if (typeof params.rotateTouch === 'string') {\n        el.classList.add(`atropos-rotate-touch-${params.rotateTouch}`);\n      } else {\n        el.classList.add('atropos-rotate-touch');\n      }\n    }\n    if ($(el, '[data-atropos-opacity]')) {\n      setChildrenOffset({ opacityOnly: true });\n    }\n    $on(document, 'click', onDocumentClick);\n    $on(eventsEl, 'pointerdown', onPointerEnter);\n    $on(eventsEl, 'pointerenter', onPointerEnter);\n    $on(eventsEl, 'pointermove', onPointerMove);\n    $on(eventsEl, 'touchmove', onTouchMove);\n    $on(eventsEl, 'pointerleave', onPointerLeave);\n    $on(eventsEl, 'pointerup', onPointerLeave);\n    $on(eventsEl, 'lostpointercapture', onPointerLeave);\n\n    if (params.alwaysActive) {\n      activate();\n      setElements();\n    }\n  };\n\n  const destroy = () => {\n    self.destroyed = true;\n    cancelAnimationFrame(queueFrameId);\n    $off(document, 'click', onDocumentClick);\n    $off(eventsEl, 'pointerdown', onPointerEnter);\n    $off(eventsEl, 'pointerenter', onPointerEnter);\n    $off(eventsEl, 'pointermove', onPointerMove);\n    $off(eventsEl, 'touchmove', onTouchMove);\n    $off(eventsEl, 'pointerleave', onPointerLeave);\n    $off(eventsEl, 'pointerup', onPointerLeave);\n    $off(eventsEl, 'lostpointercapture', onPointerLeave);\n    // eslint-disable-next-line\n    delete el.__atropos__;\n  };\n\n  self.destroy = destroy;\n\n  init();\n\n  // eslint-disable-next-line\n  return self;\n}\nexport { Atropos };\nexport default Atropos;\n"],"names":["$","el","sel","querySelector","$$","querySelectorAll","removeUndefinedProps","obj","result","Object","keys","forEach","key","Atropos","originalParams","eventsEl","self","__atropos__","params","alwaysActive","activeOffset","shadowOffset","shadowScale","duration","rotate","rotateTouch","rotateXMax","rotateYMax","rotateXInvert","rotateYInvert","stretchX","stretchY","stretchZ","commonOrigin","shadow","highlight","onEnter","onLeave","onRotate","destroyed","isActive","rotateEl","scaleEl","innerEl","elBoundingClientRect","eventsElBoundingClientRect","shadowEl","highlightEl","isScrolling","clientXStart","clientYStart","queue","queueFrameId","purgeQueue","requestAnimationFrame","data","element","prop","value","style","splice","length","$setDuration","push","$setEasing","$setTransform","$setOpacity","$setOrigin","$on","event","handler","props","addEventListener","$off","removeEventListener","createShadow","created","document","createElement","classList","add","appendChild","createHighlight","setChildrenOffset","rotateXPercentage","rotateYPercentage","opacityOnly","easeOut","getOpacity","dataset","atroposOpacity","split","map","v","parseFloat","undefined","childEl","elementOpacity","childElOffset","atroposOffset","Number","isNaN","min","max","rotatePercentage","Math","abs","setElements","clientX","clientY","isMultiple","getBoundingClientRect","rect","left","width","top","height","rotateX","rotateY","transformOrigin","centerX","centerY","coordX","coordY","parentTop","parentLeft","parentWidth","parentHeight","offsetLeft","offsetTop","activate","onPointerEnter","e","type","pointerType","preventDefault","onTouchMove","cancelable","onPointerMove","diffX","diffY","touchAngle","atan2","PI","onPointerLeave","remove","onDocumentClick","clickTarget","target","contains","initDOM","assign","init","destroy","cancelAnimationFrame"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAAA;EACA,IAAMA,CAAC,GAAG,SAAJA,CAAI,CAACC,EAAD,EAAKC,GAAL,EAAA;EAAA,EAAA,OAAaD,EAAE,CAACE,aAAH,CAAiBD,GAAjB,CAAb,CAAA;EAAA,CAAV,CAAA;;EACA,IAAME,EAAE,GAAG,SAALA,EAAK,CAACH,EAAD,EAAKC,GAAL,EAAA;EAAA,EAAA,OAAaD,EAAE,CAACI,gBAAH,CAAoBH,GAApB,CAAb,CAAA;EAAA,CAAX,CAAA;;EAEA,IAAMI,oBAAoB,GAAG,SAAvBA,oBAAuB,CAACC,GAAD,EAAc;EAAA,EAAA,IAAbA,GAAa,KAAA,KAAA,CAAA,EAAA;EAAbA,IAAAA,GAAa,GAAP,EAAO,CAAA;EAAA,GAAA;;IACzC,IAAMC,MAAM,GAAG,EAAf,CAAA;IACAC,MAAM,CAACC,IAAP,CAAYH,GAAZ,EAAiBI,OAAjB,CAAyB,UAACC,GAAD,EAAS;EAChC,IAAA,IAAI,OAAOL,GAAG,CAACK,GAAD,CAAV,KAAoB,WAAxB,EAAqCJ,MAAM,CAACI,GAAD,CAAN,GAAcL,GAAG,CAACK,GAAD,CAAjB,CAAA;KADvC,CAAA,CAAA;EAGA,EAAA,OAAOJ,MAAP,CAAA;EACD,CAND,CAAA;;EAQA,SAASK,OAAT,CAAiBC,cAAjB,EAAsC;EAAA,EAAA,IAArBA,cAAqB,KAAA,KAAA,CAAA,EAAA;EAArBA,IAAAA,cAAqB,GAAJ,EAAI,CAAA;EAAA,GAAA;;EACpC,EAAA,IAAA,eAAA,GAAuBA,cAAvB;QAAMb,EAAN,mBAAMA,EAAN;QAAUc,QAAV,mBAAUA,QAAV,CAAA;EAEA,EAAA,IAAMC,IAAI,GAAG;EACXC,IAAAA,WAAW,EAAE,IADF;MAEXC,MAAM,EAAA,QAAA,CAAA;EACJC,MAAAA,YAAY,EAAE,KADV;EAEJC,MAAAA,YAAY,EAAE,EAFV;EAGJC,MAAAA,YAAY,EAAE,EAHV;EAIJC,MAAAA,WAAW,EAAE,CAJT;EAKJC,MAAAA,QAAQ,EAAE,GALN;EAMJC,MAAAA,MAAM,EAAE,IANJ;EAOJC,MAAAA,WAAW,EAAE,IAPT;EAQJC,MAAAA,UAAU,EAAE,EARR;EASJC,MAAAA,UAAU,EAAE,EATR;EAUJC,MAAAA,aAAa,EAAE,KAVX;EAWJC,MAAAA,aAAa,EAAE,KAXX;EAYJC,MAAAA,QAAQ,EAAE,CAZN;EAaJC,MAAAA,QAAQ,EAAE,CAbN;EAcJC,MAAAA,QAAQ,EAAE,CAdN;EAeJC,MAAAA,YAAY,EAAE,IAfV;EAgBJC,MAAAA,MAAM,EAAE,IAhBJ;EAiBJC,MAAAA,SAAS,EAAE,IAjBP;EAkBJC,MAAAA,OAAO,EAAE,IAlBL;EAmBJC,MAAAA,OAAO,EAAE,IAnBL;EAoBJC,MAAAA,QAAQ,EAAE,IAAA;EApBN,KAAA,EAqBDhC,oBAAoB,CAACQ,cAAc,IAAI,EAAnB,CArBnB,CAFK;EAyBXyB,IAAAA,SAAS,EAAE,KAzBA;EA0BXC,IAAAA,QAAQ,EAAE,KAAA;KA1BZ,CAAA;EA6BA,EAAA,IAAQtB,MAAR,GAAmBF,IAAnB,CAAQE,MAAR,CAAA;EAEA,EAAA,IAAIuB,QAAJ,CAAA;EACA,EAAA,IAAIC,OAAJ,CAAA;EACA,EAAA,IAAIC,OAAJ,CAAA;EAEA,EAAA,IAAIC,oBAAJ,CAAA;EACA,EAAA,IAAIC,0BAAJ,CAAA;EAEA,EAAA,IAAIC,QAAJ,CAAA;EACA,EAAA,IAAIC,WAAJ,CAAA;EAEA,EAAA,IAAIC,WAAJ,CAAA;EACA,EAAA,IAAIC,YAAJ,CAAA;EACA,EAAA,IAAIC,YAAJ,CAAA;IAEA,IAAMC,KAAK,GAAG,EAAd,CAAA;EACA,EAAA,IAAIC,YAAJ,CAAA;;EACA,EAAA,IAAMC,UAAU,GAAG,SAAbA,UAAa,GAAM;MACvBD,YAAY,GAAGE,qBAAqB,CAAC,YAAM;EACzCH,MAAAA,KAAK,CAACxC,OAAN,CAAc,UAAC4C,IAAD,EAAU;EACtB,QAAA,IAAI,OAAOA,IAAP,KAAgB,UAApB,EAAgC;YAC9BA,IAAI,EAAA,CAAA;EACL,SAFD,MAEO;EACL,UAAA,IAAQC,OAAR,GAAiCD,IAAjC,CAAQC,OAAR;EAAA,cAAiBC,IAAjB,GAAiCF,IAAjC,CAAiBE,IAAjB;EAAA,cAAuBC,KAAvB,GAAiCH,IAAjC,CAAuBG,KAAvB,CAAA;EACAF,UAAAA,OAAO,CAACG,KAAR,CAAcF,IAAd,IAAsBC,KAAtB,CAAA;EACD,SAAA;SANH,CAAA,CAAA;EAQAP,MAAAA,KAAK,CAACS,MAAN,CAAa,CAAb,EAAgBT,KAAK,CAACU,MAAtB,CAAA,CAAA;QACAR,UAAU,EAAA,CAAA;EACX,KAXmC,CAApC,CAAA;KADF,CAAA;;IAcAA,UAAU,EAAA,CAAA;;IAEV,IAAMS,YAAY,GAAG,SAAfA,YAAe,CAACN,OAAD,EAAUE,KAAV,EAAoB;MACvCP,KAAK,CAACY,IAAN,CAAW;EAAEP,MAAAA,OAAO,EAAPA,OAAF;EAAWC,MAAAA,IAAI,EAAE,oBAAjB;EAAuCC,MAAAA,KAAK,EAALA,KAAAA;OAAlD,CAAA,CAAA;KADF,CAAA;;IAGA,IAAMM,UAAU,GAAG,SAAbA,UAAa,CAACR,OAAD,EAAUE,KAAV,EAAoB;MACrCP,KAAK,CAACY,IAAN,CAAW;EAAEP,MAAAA,OAAO,EAAPA,OAAF;EAAWC,MAAAA,IAAI,EAAE,0BAAjB;EAA6CC,MAAAA,KAAK,EAALA,KAAAA;OAAxD,CAAA,CAAA;KADF,CAAA;;IAGA,IAAMO,aAAa,GAAG,SAAhBA,aAAgB,CAACT,OAAD,EAAUE,KAAV,EAAoB;MACxCP,KAAK,CAACY,IAAN,CAAW;EAAEP,MAAAA,OAAO,EAAPA,OAAF;EAAWC,MAAAA,IAAI,EAAE,WAAjB;EAA8BC,MAAAA,KAAK,EAALA,KAAAA;OAAzC,CAAA,CAAA;KADF,CAAA;;IAGA,IAAMQ,WAAW,GAAG,SAAdA,WAAc,CAACV,OAAD,EAAUE,KAAV,EAAoB;MACtCP,KAAK,CAACY,IAAN,CAAW;EAAEP,MAAAA,OAAO,EAAPA,OAAF;EAAWC,MAAAA,IAAI,EAAE,SAAjB;EAA4BC,MAAAA,KAAK,EAALA,KAAAA;OAAvC,CAAA,CAAA;KADF,CAAA;;IAGA,IAAMS,UAAU,GAAG,SAAbA,UAAa,CAACX,OAAD,EAAUE,KAAV,EAAoB;MACrCP,KAAK,CAACY,IAAN,CAAW;EAAEP,MAAAA,OAAO,EAAPA,OAAF;EAAWC,MAAAA,IAAI,EAAE,iBAAjB;EAAoCC,MAAAA,KAAK,EAALA,KAAAA;OAA/C,CAAA,CAAA;KADF,CAAA;;IAGA,IAAMU,GAAG,GAAG,SAANA,GAAM,CAACZ,OAAD,EAAUa,KAAV,EAAiBC,OAAjB,EAA0BC,KAA1B,EAAA;MAAA,OAAoCf,OAAO,CAACgB,gBAAR,CAAyBH,KAAzB,EAAgCC,OAAhC,EAAyCC,KAAzC,CAApC,CAAA;KAAZ,CAAA;;IACA,IAAME,IAAI,GAAG,SAAPA,IAAO,CAACjB,OAAD,EAAUa,KAAV,EAAiBC,OAAjB,EAA0BC,KAA1B,EAAA;MAAA,OACXf,OAAO,CAACkB,mBAAR,CAA4BL,KAA5B,EAAmCC,OAAnC,EAA4CC,KAA5C,CADW,CAAA;KAAb,CAAA;;EAGA,EAAA,IAAMI,YAAY,GAAG,SAAfA,YAAe,GAAM;EACzB,IAAA,IAAIC,OAAJ,CAAA;EACA9B,IAAAA,QAAQ,GAAG9C,CAAC,CAACC,EAAD,EAAK,iBAAL,CAAZ,CAAA;;MACA,IAAI,CAAC6C,QAAL,EAAe;EACbA,MAAAA,QAAQ,GAAG+B,QAAQ,CAACC,aAAT,CAAuB,MAAvB,CAAX,CAAA;EACAhC,MAAAA,QAAQ,CAACiC,SAAT,CAAmBC,GAAnB,CAAuB,gBAAvB,CAAA,CAAA;EACAJ,MAAAA,OAAO,GAAG,IAAV,CAAA;EACD,KAAA;;MACDX,aAAa,CACXnB,QADW,EAAA,mBAAA,GAES5B,MAAM,CAACG,YAFhB,GAEyCH,YAAAA,GAAAA,MAAM,CAACI,WAFhD,GAAb,GAAA,CAAA,CAAA;;EAIA,IAAA,IAAIsD,OAAJ,EAAa;QACXnC,QAAQ,CAACwC,WAAT,CAAqBnC,QAArB,CAAA,CAAA;EACD,KAAA;KAdH,CAAA;;EAgBA,EAAA,IAAMoC,eAAe,GAAG,SAAlBA,eAAkB,GAAM;EAC5B,IAAA,IAAIN,OAAJ,CAAA;EACA7B,IAAAA,WAAW,GAAG/C,CAAC,CAACC,EAAD,EAAK,oBAAL,CAAf,CAAA;;MACA,IAAI,CAAC8C,WAAL,EAAkB;EAChBA,MAAAA,WAAW,GAAG8B,QAAQ,CAACC,aAAT,CAAuB,MAAvB,CAAd,CAAA;EACA/B,MAAAA,WAAW,CAACgC,SAAZ,CAAsBC,GAAtB,CAA0B,mBAA1B,CAAA,CAAA;EACAJ,MAAAA,OAAO,GAAG,IAAV,CAAA;EACD,KAAA;;MAEDX,aAAa,CAAClB,WAAD,EAAb,oBAAA,CAAA,CAAA;;EACA,IAAA,IAAI6B,OAAJ,EAAa;QACXjC,OAAO,CAACsC,WAAR,CAAoBlC,WAApB,CAAA,CAAA;EACD,KAAA;KAZH,CAAA;;EAeA,EAAA,IAAMoC,iBAAiB,GAAG,SAApBA,iBAAoB,CAMpB,IAAA,EAAA;EAAA,IAAA,IAAA,qBAAA,GAAA,IAAA,CALJC,iBAKI;UALJA,iBAKI,sCALgB,CAKhB,GAAA,qBAAA;EAAA,QAAA,qBAAA,GAAA,IAAA,CAJJC,iBAII;UAJJA,iBAII,sCAJgB,CAIhB,GAAA,qBAAA;UAHJ9D,QAGI,QAHJA,QAGI;UAFJ+D,WAEI,QAFJA,WAEI;UADJC,OACI,QADJA,OACI,CAAA;;EACJ,IAAA,IAAMC,UAAU,GAAG,SAAbA,UAAa,CAAChC,OAAD,EAAa;EAC9B,MAAA,IAAIA,OAAO,CAACiC,OAAR,CAAgBC,cAAhB,IAAkC,OAAOlC,OAAO,CAACiC,OAAR,CAAgBC,cAAvB,KAA0C,QAAhF,EAA0F;EACxF,QAAA,OAAOlC,OAAO,CAACiC,OAAR,CAAgBC,cAAhB,CAA+BC,KAA/B,CAAqC,GAArC,CAAA,CAA0CC,GAA1C,CAA8C,UAACC,CAAD,EAAA;YAAA,OAAOC,UAAU,CAACD,CAAD,CAAjB,CAAA;EAAA,SAA9C,CAAP,CAAA;EACD,OAAA;;EACD,MAAA,OAAOE,SAAP,CAAA;OAJF,CAAA;;MAMA3F,EAAE,CAACH,EAAD,EAAK,+CAAL,CAAF,CAAwDU,OAAxD,CAAgE,UAACqF,OAAD,EAAa;EAC3ElC,MAAAA,YAAY,CAACkC,OAAD,EAAUzE,QAAV,CAAZ,CAAA;QACAyC,UAAU,CAACgC,OAAD,EAAUT,OAAO,GAAG,UAAH,GAAgB,EAAjC,CAAV,CAAA;EACA,MAAA,IAAMU,cAAc,GAAGT,UAAU,CAACQ,OAAD,CAAjC,CAAA;;EACA,MAAA,IAAIZ,iBAAiB,KAAK,CAAtB,IAA2BC,iBAAiB,KAAK,CAArD,EAAwD;EACtD,QAAA,IAAI,CAACC,WAAL,EAAkBrB,aAAa,CAAC+B,OAAD,EAAb,sBAAA,CAAA,CAAA;UAClB,IAAIC,cAAJ,EAAoB/B,WAAW,CAAC8B,OAAD,EAAUC,cAAc,CAAC,CAAD,CAAxB,CAAX,CAAA;EACrB,OAHD,MAGO;UACL,IAAMC,aAAa,GAAGJ,UAAU,CAACE,OAAO,CAACP,OAAR,CAAgBU,aAAjB,CAAV,GAA4C,GAAlE,CAAA;;UACA,IAAI,CAACC,MAAM,CAACC,KAAP,CAAaH,aAAb,CAAD,IAAgC,CAACZ,WAArC,EAAkD;EAChDrB,UAAAA,aAAa,CACX+B,OADW,EAEI,cAAA,GAAA,CAACX,iBAAD,GAAqB,CAACa,aAF1B,GAGTd,KAAAA,GAAAA,iBAAiB,GAAG,CAACc,aAHZ,GAAb,OAAA,CAAA,CAAA;EAMD,SAAA;;EACD,QAAA,IAAID,cAAJ,EAAoB;YAClB,IAAOK,GAAP,GAAmBL,cAAnB,CAAA,CAAA,CAAA;gBAAYM,GAAZ,GAAmBN,cAAnB,CAAA,CAAA,CAAA,CAAA;EACA,UAAA,IAAMO,gBAAgB,GAAGC,IAAI,CAACF,GAAL,CACvBE,IAAI,CAACC,GAAL,CAAStB,iBAAT,CADuB,EAEvBqB,IAAI,CAACC,GAAL,CAASrB,iBAAT,CAFuB,CAAzB,CAAA;EAIAnB,UAAAA,WAAW,CAAC8B,OAAD,EAAUM,GAAG,GAAI,CAACC,GAAG,GAAGD,GAAP,IAAcE,gBAAf,GAAmC,GAAnD,CAAX,CAAA;EACD,SAAA;EACF,OAAA;OAzBH,CAAA,CAAA;KAbF,CAAA;;IA0CA,IAAMG,WAAW,GAAG,SAAdA,WAAc,CAACC,OAAD,EAAUC,OAAV,EAAsB;EACxC,IAAA,IAAMC,UAAU,GAAG7G,EAAE,KAAKc,QAA1B,CAAA;;MACA,IAAI,CAAC6B,oBAAL,EAA2B;EACzBA,MAAAA,oBAAoB,GAAG3C,EAAE,CAAC8G,qBAAH,EAAvB,CAAA;EACD,KAAA;;EACD,IAAA,IAAID,UAAU,IAAI,CAACjE,0BAAnB,EAA+C;EAC7CA,MAAAA,0BAA0B,GAAG9B,QAAQ,CAACgG,qBAAT,EAA7B,CAAA;EACD,KAAA;;MACD,IAAI,OAAOH,OAAP,KAAmB,WAAnB,IAAkC,OAAOC,OAAP,KAAmB,WAAzD,EAAsE;EACpE,MAAA,IAAMG,IAAI,GAAGF,UAAU,GAAGjE,0BAAH,GAAgCD,oBAAvD,CAAA;QACAgE,OAAO,GAAGI,IAAI,CAACC,IAAL,GAAYD,IAAI,CAACE,KAAL,GAAa,CAAnC,CAAA;QACAL,OAAO,GAAGG,IAAI,CAACG,GAAL,GAAWH,IAAI,CAACI,MAAL,GAAc,CAAnC,CAAA;EACD,KAAA;;MAED,IAAIC,OAAO,GAAG,CAAd,CAAA;MACA,IAAIC,OAAO,GAAG,CAAd,CAAA;EACA,IAAA,IAAA,qBAAA,GAAqC1E,oBAArC;UAAQuE,GAAR,yBAAQA,GAAR;UAAaF,IAAb,yBAAaA,IAAb;UAAmBC,KAAnB,yBAAmBA,KAAnB;UAA0BE,MAA1B,yBAA0BA,MAA1B,CAAA;EACA,IAAA,IAAIG,eAAJ,CAAA;;MACA,IAAI,CAACT,UAAL,EAAiB;EACf,MAAA,IAAMU,OAAO,GAAGN,KAAK,GAAG,CAAxB,CAAA;EACA,MAAA,IAAMO,OAAO,GAAGL,MAAM,GAAG,CAAzB,CAAA;EAEA,MAAA,IAAMM,MAAM,GAAGd,OAAO,GAAGK,IAAzB,CAAA;EACA,MAAA,IAAMU,MAAM,GAAGd,OAAO,GAAGM,GAAzB,CAAA;EAEAG,MAAAA,OAAO,GAAKpG,MAAM,CAACS,UAAP,IAAqB+F,MAAM,GAAGF,OAA9B,CAAD,IAA4CN,KAAK,GAAG,CAApD,CAAD,GAA2D,CAAC,CAAtE,CAAA;EACAG,MAAAA,OAAO,GAAInG,MAAM,CAACQ,UAAP,IAAqBiG,MAAM,GAAGF,OAA9B,CAAD,IAA4CL,MAAM,GAAG,CAArD,CAAV,CAAA;EACD,KATD,MASO;EACL,MAAA,IAAA,qBAAA,GAKIvE,0BALJ;YACO+E,SADP,yBACET,GADF;YAEQU,UAFR,yBAEEZ,IAFF;YAGSa,WAHT,yBAGEZ,KAHF;YAIUa,YAJV,yBAIEX,MAJF,CAAA;EAMA,MAAA,IAAMY,UAAU,GAAGf,IAAI,GAAGY,UAA1B,CAAA;EACA,MAAA,IAAMI,SAAS,GAAGd,GAAG,GAAGS,SAAxB,CAAA;;EAEA,MAAA,IAAMJ,QAAO,GAAGN,KAAK,GAAG,CAAR,GAAYc,UAA5B,CAAA;;EACA,MAAA,IAAMP,QAAO,GAAGL,MAAM,GAAG,CAAT,GAAaa,SAA7B,CAAA;;EAEA,MAAA,IAAMP,OAAM,GAAGd,OAAO,GAAGiB,UAAzB,CAAA;;EACA,MAAA,IAAMF,OAAM,GAAGd,OAAO,GAAGe,SAAzB,CAAA;;EAEAN,MAAAA,OAAO,GAAKpG,MAAM,CAACS,UAAP,IAAqB+F,OAAM,GAAGF,QAA9B,CAAD,IAA4CM,WAAW,GAAGZ,KAAK,GAAG,CAAlE,CAAD,GAAyE,CAAC,CAApF,CAAA;EACAG,MAAAA,OAAO,GAAInG,MAAM,CAACQ,UAAP,IAAqBiG,OAAM,GAAGF,QAA9B,CAAD,IAA4CM,YAAY,GAAGX,MAAM,GAAG,CAApE,CAAV,CAAA;QACAG,eAAe,GAAMX,OAAO,GAAGK,IAAhB,YAA0BJ,OAAO,GAAGM,GAApC,CAAf,GAAA,IAAA,CAAA;EACD,KAAA;;MAEDE,OAAO,GAAGZ,IAAI,CAACH,GAAL,CAASG,IAAI,CAACF,GAAL,CAAS,CAACc,OAAV,EAAmB,CAACnG,MAAM,CAACQ,UAA3B,CAAT,EAAiDR,MAAM,CAACQ,UAAxD,CAAV,CAAA;EACA,IAAA,IAAIR,MAAM,CAACU,aAAX,EAA0ByF,OAAO,GAAG,CAACA,OAAX,CAAA;MAC1BC,OAAO,GAAGb,IAAI,CAACH,GAAL,CAASG,IAAI,CAACF,GAAL,CAAS,CAACe,OAAV,EAAmB,CAACpG,MAAM,CAACS,UAA3B,CAAT,EAAiDT,MAAM,CAACS,UAAxD,CAAV,CAAA;EACA,IAAA,IAAIT,MAAM,CAACW,aAAX,EAA0ByF,OAAO,GAAG,CAACA,OAAX,CAAA;MAE1B,IAAMlC,iBAAiB,GAAIiC,OAAO,GAAGnG,MAAM,CAACQ,UAAlB,GAAgC,GAA1D,CAAA;MACA,IAAM2D,iBAAiB,GAAIiC,OAAO,GAAGpG,MAAM,CAACS,UAAlB,GAAgC,GAA1D,CAAA;MAEA,IAAMG,QAAQ,GACZ,CAACgF,UAAU,GAAIzB,iBAAiB,GAAG,GAArB,GAA4BnE,MAAM,CAACY,QAAtC,GAAiD,CAA5D,KACCZ,MAAM,CAACW,aAAP,GAAuB,CAAC,CAAxB,GAA4B,CAD7B,CADF,CAAA;MAGA,IAAME,QAAQ,GACZ,CAAC+E,UAAU,GAAI1B,iBAAiB,GAAG,GAArB,GAA4BlE,MAAM,CAACa,QAAtC,GAAiD,CAA5D,KACCb,MAAM,CAACU,aAAP,GAAuB,CAAC,CAAxB,GAA4B,CAD7B,CADF,CAAA;EAGA,IAAA,IAAMI,QAAQ,GAAG8E,UAAU,GACtBL,IAAI,CAACF,GAAL,CAASE,IAAI,CAACC,GAAL,CAAStB,iBAAT,CAAT,EAAsCqB,IAAI,CAACC,GAAL,CAASrB,iBAAT,CAAtC,CAAA,GAAqE,GAAtE,GAA6EnE,MAAM,CAACc,QAD7D,GAEvB,CAFJ,CAAA;EAGAiC,IAAAA,aAAa,CACXxB,QADW,EAEIX,cAAAA,GAAAA,QAFJ,WAEkB,CAACC,QAFnB,GAEiC,KAAA,GAAA,CAACC,QAFlC,GAAA,cAAA,GAEyDqF,OAFzD,GAAA,eAAA,GAEgFC,OAFhF,GAAb,MAAA,CAAA,CAAA;;EAIA,IAAA,IAAIC,eAAe,IAAIrG,MAAM,CAACe,YAA9B,EAA4C;EAC1CkC,MAAAA,UAAU,CAAC1B,QAAD,EAAW8E,eAAX,CAAV,CAAA;EACD,KAAA;;EAED,IAAA,IAAIxE,WAAJ,EAAiB;EACfe,MAAAA,YAAY,CAACf,WAAD,EAAiB7B,MAAM,CAACK,QAAxB,GAAZ,IAAA,CAAA,CAAA;EACAyC,MAAAA,UAAU,CAACjB,WAAD,EAAc,UAAd,CAAV,CAAA;QACAkB,aAAa,CACXlB,WADW,EAAA,cAAA,GAEI,CAACsC,iBAAD,GAAqB,IAFzB,GAEmCD,KAAAA,GAAAA,iBAAiB,GAAG,IAFvD,GAAb,OAAA,CAAA,CAAA;QAIAlB,WAAW,CACTnB,WADS,EAET0D,IAAI,CAACF,GAAL,CAASE,IAAI,CAACC,GAAL,CAAStB,iBAAT,CAAT,EAAsCqB,IAAI,CAACC,GAAL,CAASrB,iBAAT,CAAtC,CAAqE,GAAA,GAF5D,CAAX,CAAA;EAID,KAAA;;EAEDF,IAAAA,iBAAiB,CAAC;EAChBC,MAAAA,iBAAiB,EAAjBA,iBADgB;EAEhBC,MAAAA,iBAAiB,EAAjBA,iBAFgB;EAGhB9D,MAAAA,QAAQ,EAAKL,MAAM,CAACK,QAAZ,GAHQ,IAAA;EAIhBgE,MAAAA,OAAO,EAAE,IAAA;EAJO,KAAD,CAAjB,CAAA;EAOA,IAAA,IAAI,OAAOrE,MAAM,CAACoB,QAAd,KAA2B,UAA/B,EAA2CpB,MAAM,CAACoB,QAAP,CAAgB+E,OAAhB,EAAyBC,OAAzB,CAAA,CAAA;KA7F7C,CAAA;;EAgGA,EAAA,IAAMY,QAAQ,GAAG,SAAXA,QAAW,GAAM;MACrB/E,KAAK,CAACY,IAAN,CAAW,YAAA;EAAA,MAAA,OAAM9D,EAAE,CAAC8E,SAAH,CAAaC,GAAb,CAAiB,gBAAjB,CAAN,CAAA;OAAX,CAAA,CAAA;EACAlB,IAAAA,YAAY,CAACrB,QAAD,EAAcvB,MAAM,CAACK,QAArB,GAAZ,IAAA,CAAA,CAAA;EACAyC,IAAAA,UAAU,CAACvB,QAAD,EAAW,UAAX,CAAV,CAAA;EACAwB,IAAAA,aAAa,CAACvB,OAAD,EAAA,mBAAA,GAA8BxB,MAAM,CAACE,YAArC,GAAb,KAAA,CAAA,CAAA;EACA0C,IAAAA,YAAY,CAACpB,OAAD,EAAaxB,MAAM,CAACK,QAApB,GAAZ,IAAA,CAAA,CAAA;EACAyC,IAAAA,UAAU,CAACtB,OAAD,EAAU,UAAV,CAAV,CAAA;;EACA,IAAA,IAAII,QAAJ,EAAc;EACZgB,MAAAA,YAAY,CAAChB,QAAD,EAAc5B,MAAM,CAACK,QAArB,GAAZ,IAAA,CAAA,CAAA;EACAyC,MAAAA,UAAU,CAAClB,QAAD,EAAW,UAAX,CAAV,CAAA;EACD,KAAA;;MAED9B,IAAI,CAACwB,QAAL,GAAgB,IAAhB,CAAA;KAZF,CAAA;;EAeA,EAAA,IAAM2F,cAAc,GAAG,SAAjBA,cAAiB,CAACC,CAAD,EAAO;EAC5BpF,IAAAA,WAAW,GAAG+C,SAAd,CAAA;MACA,IAAIqC,CAAC,CAACC,IAAF,KAAW,aAAX,IAA4BD,CAAC,CAACE,WAAF,KAAkB,OAAlD,EAA2D,OAAA;MAC3D,IAAIF,CAAC,CAACC,IAAF,KAAW,cAAX,IAA6BD,CAAC,CAACE,WAAF,KAAkB,OAAnD,EAA4D,OAAA;;EAC5D,IAAA,IAAIF,CAAC,CAACC,IAAF,KAAW,aAAf,EAA8B;EAC5BD,MAAAA,CAAC,CAACG,cAAF,EAAA,CAAA;EACD,KAAA;;MACDtF,YAAY,GAAGmF,CAAC,CAACxB,OAAjB,CAAA;MACA1D,YAAY,GAAGkF,CAAC,CAACvB,OAAjB,CAAA;;MAEA,IAAI3F,MAAM,CAACC,YAAX,EAAyB;EACvByB,MAAAA,oBAAoB,GAAGmD,SAAvB,CAAA;EACAlD,MAAAA,0BAA0B,GAAGkD,SAA7B,CAAA;EACA,MAAA,OAAA;EACD,KAAA;;MACDmC,QAAQ,EAAA,CAAA;MACR,IAAI,OAAOhH,MAAM,CAACkB,OAAd,KAA0B,UAA9B,EAA0ClB,MAAM,CAACkB,OAAP,EAAA,CAAA;KAhB5C,CAAA;;EAmBA,EAAA,IAAMoG,WAAW,GAAG,SAAdA,WAAc,CAACJ,CAAD,EAAO;EACzB,IAAA,IAAIpF,WAAW,KAAK,KAAhB,IAAyBoF,CAAC,CAACK,UAA/B,EAA2C;EACzCL,MAAAA,CAAC,CAACG,cAAF,EAAA,CAAA;EACD,KAAA;KAHH,CAAA;;EAMA,EAAA,IAAMG,aAAa,GAAG,SAAhBA,aAAgB,CAACN,CAAD,EAAO;MAC3B,IAAI,CAAClH,MAAM,CAACM,MAAR,IAAkB,CAACR,IAAI,CAACwB,QAA5B,EAAsC,OAAA;;EACtC,IAAA,IAAI4F,CAAC,CAACE,WAAF,KAAkB,OAAtB,EAA+B;EAC7B,MAAA,IAAI,CAACpH,MAAM,CAACO,WAAZ,EAAyB,OAAA;EACzB2G,MAAAA,CAAC,CAACG,cAAF,EAAA,CAAA;EACD,KAAA;;EACD,IAAA,IAAQ3B,OAAR,GAA6BwB,CAA7B,CAAQxB,OAAR;EAAA,QAAiBC,OAAjB,GAA6BuB,CAA7B,CAAiBvB,OAAjB,CAAA;EAEA,IAAA,IAAM8B,KAAK,GAAG/B,OAAO,GAAG3D,YAAxB,CAAA;EACA,IAAA,IAAM2F,KAAK,GAAG/B,OAAO,GAAG3D,YAAxB,CAAA;;EACA,IAAA,IACE,OAAOhC,MAAM,CAACO,WAAd,KAA8B,QAA9B,KACCkH,KAAK,KAAK,CAAV,IAAeC,KAAK,KAAK,CAD1B,CAAA,IAEA,OAAO5F,WAAP,KAAuB,WAHzB,EAIE;QACA,IAAI2F,KAAK,GAAGA,KAAR,GAAgBC,KAAK,GAAGA,KAAxB,IAAiC,EAArC,EAAyC;UACvC,IAAMC,UAAU,GAAIpC,IAAI,CAACqC,KAAL,CAAWrC,IAAI,CAACC,GAAL,CAASkC,KAAT,CAAX,EAA4BnC,IAAI,CAACC,GAAL,CAASiC,KAAT,CAA5B,IAA+C,GAAhD,GAAuDlC,IAAI,CAACsC,EAA/E,CAAA;EACA/F,QAAAA,WAAW,GAAG9B,MAAM,CAACO,WAAP,KAAuB,UAAvB,GAAoCoH,UAAU,GAAG,EAAjD,GAAsD,EAAKA,GAAAA,UAAL,GAAkB,EAAtF,CAAA;EACD,OAAA;;QACD,IAAI7F,WAAW,KAAK,KAApB,EAA2B;EACzB/C,QAAAA,EAAE,CAAC8E,SAAH,CAAaC,GAAb,CAAiB,sBAAjB,CAAA,CAAA;;UACA,IAAIoD,CAAC,CAACK,UAAN,EAAkB;EAChBL,UAAAA,CAAC,CAACG,cAAF,EAAA,CAAA;EACD,SAAA;EACF,OAAA;EACF,KAAA;;EACD,IAAA,IAAIH,CAAC,CAACE,WAAF,KAAkB,OAAlB,IAA6BtF,WAAjC,EAA8C;EAC5C,MAAA,OAAA;EACD,KAAA;;EACD2D,IAAAA,WAAW,CAACC,OAAD,EAAUC,OAAV,CAAX,CAAA;KA7BF,CAAA;;EAgCA,EAAA,IAAMmC,cAAc,GAAG,SAAjBA,cAAiB,CAACZ,CAAD,EAAO;EAC5BxF,IAAAA,oBAAoB,GAAGmD,SAAvB,CAAA;EACAlD,IAAAA,0BAA0B,GAAGkD,SAA7B,CAAA;EACA,IAAA,IAAI,CAAC/E,IAAI,CAACwB,QAAV,EAAoB,OAAA;EACpB,IAAA,IAAI4F,CAAC,IAAIA,CAAC,CAACC,IAAF,KAAW,WAAhB,IAA+BD,CAAC,CAACE,WAAF,KAAkB,OAArD,EAA8D,OAAA;EAC9D,IAAA,IAAIF,CAAC,IAAIA,CAAC,CAACC,IAAF,KAAW,cAAhB,IAAkCD,CAAC,CAACE,WAAF,KAAkB,OAAxD,EAAiE,OAAA;;MACjE,IAAI,OAAOpH,MAAM,CAACO,WAAd,KAA8B,QAA9B,IAA0CuB,WAA9C,EAA2D;EACzD/C,MAAAA,EAAE,CAAC8E,SAAH,CAAakE,MAAb,CAAoB,sBAApB,CAAA,CAAA;EACD,KAAA;;MAED,IAAI/H,MAAM,CAACC,YAAX,EAAyB;QACvBwF,WAAW,EAAA,CAAA;EACX,MAAA,IAAI,OAAOzF,MAAM,CAACoB,QAAd,KAA2B,UAA/B,EAA2CpB,MAAM,CAACoB,QAAP,CAAgB,CAAhB,EAAmB,CAAnB,CAAA,CAAA;QAC3C,IAAI,OAAOpB,MAAM,CAACmB,OAAd,KAA0B,UAA9B,EAA0CnB,MAAM,CAACmB,OAAP,EAAA,CAAA;EAC1C,MAAA,OAAA;EACD,KAAA;;MAEDc,KAAK,CAACY,IAAN,CAAW,YAAA;EAAA,MAAA,OAAM9D,EAAE,CAAC8E,SAAH,CAAakE,MAAb,CAAoB,gBAApB,CAAN,CAAA;OAAX,CAAA,CAAA;EACAnF,IAAAA,YAAY,CAACpB,OAAD,EAAaxB,MAAM,CAACK,QAApB,GAAZ,IAAA,CAAA,CAAA;EACAyC,IAAAA,UAAU,CAACtB,OAAD,EAAU,EAAV,CAAV,CAAA;EACAuB,IAAAA,aAAa,CAACvB,OAAD,EAA8B,mBAAA,GAAA,CAA9B,GAAb,KAAA,CAAA,CAAA;;EACA,IAAA,IAAII,QAAJ,EAAc;EACZgB,MAAAA,YAAY,CAAChB,QAAD,EAAc5B,MAAM,CAACK,QAArB,GAAZ,IAAA,CAAA,CAAA;EACAyC,MAAAA,UAAU,CAAClB,QAAD,EAAW,EAAX,CAAV,CAAA;EACD,KAAA;;EACD,IAAA,IAAIC,WAAJ,EAAiB;EACfe,MAAAA,YAAY,CAACf,WAAD,EAAiB7B,MAAM,CAACK,QAAxB,GAAZ,IAAA,CAAA,CAAA;EACAyC,MAAAA,UAAU,CAACjB,WAAD,EAAc,EAAd,CAAV,CAAA;QACAkB,aAAa,CAAClB,WAAD,EAAb,sBAAA,CAAA,CAAA;EACAmB,MAAAA,WAAW,CAACnB,WAAD,EAAc,CAAd,CAAX,CAAA;EACD,KAAA;;EACDe,IAAAA,YAAY,CAACrB,QAAD,EAAcvB,MAAM,CAACK,QAArB,GAAZ,IAAA,CAAA,CAAA;EACAyC,IAAAA,UAAU,CAACvB,QAAD,EAAW,EAAX,CAAV,CAAA;MACAwB,aAAa,CAACxB,QAAD,EAAb,gDAAA,CAAA,CAAA;EAEA0C,IAAAA,iBAAiB,CAAC;QAAE5D,QAAQ,EAAKL,MAAM,CAACK,QAAZ,GAAA,IAAA;EAAV,KAAD,CAAjB,CAAA;MAEAP,IAAI,CAACwB,QAAL,GAAgB,KAAhB,CAAA;EACA,IAAA,IAAI,OAAOtB,MAAM,CAACoB,QAAd,KAA2B,UAA/B,EAA2CpB,MAAM,CAACoB,QAAP,CAAgB,CAAhB,EAAmB,CAAnB,CAAA,CAAA;MAC3C,IAAI,OAAOpB,MAAM,CAACmB,OAAd,KAA0B,UAA9B,EAA0CnB,MAAM,CAACmB,OAAP,EAAA,CAAA;KAvC5C,CAAA;;EA0CA,EAAA,IAAM6G,eAAe,GAAG,SAAlBA,eAAkB,CAACd,CAAD,EAAO;EAC7B,IAAA,IAAMe,WAAW,GAAGf,CAAC,CAACgB,MAAtB,CAAA;;EACA,IAAA,IAAI,CAACrI,QAAQ,CAACsI,QAAT,CAAkBF,WAAlB,CAAD,IAAmCA,WAAW,KAAKpI,QAAnD,IAA+DC,IAAI,CAACwB,QAAxE,EAAkF;QAChFwG,cAAc,EAAA,CAAA;EACf,KAAA;KAJH,CAAA;;EAOA,EAAA,IAAMM,OAAO,GAAG,SAAVA,OAAU,GAAM;EACpB,IAAA,IAAI,OAAOrJ,EAAP,KAAc,QAAlB,EAA4B;EAC1BA,MAAAA,EAAE,GAAGD,CAAC,CAAC6E,QAAD,EAAW5E,EAAX,CAAN,CAAA;EACD,KAAA;;EACD,IAAA,IAAI,CAACA,EAAL,EAAS,OAJW;;MAOpB,IAAIA,EAAE,CAACgB,WAAP,EAAoB,OAAA;;EAEpB,IAAA,IAAI,OAAOF,QAAP,KAAoB,WAAxB,EAAqC;EACnC,MAAA,IAAI,OAAOA,QAAP,KAAoB,QAAxB,EAAkC;EAChCA,QAAAA,QAAQ,GAAGf,CAAC,CAAC6E,QAAD,EAAW9D,QAAX,CAAZ,CAAA;EACD,OAAA;EACF,KAJD,MAIO;EACLA,MAAAA,QAAQ,GAAGd,EAAX,CAAA;EACD,KAAA;;EAEDQ,IAAAA,MAAM,CAAC8I,MAAP,CAAcvI,IAAd,EAAoB;EAClBf,MAAAA,EAAE,EAAFA,EAAAA;OADF,CAAA,CAAA;EAIAwC,IAAAA,QAAQ,GAAGzC,CAAC,CAACC,EAAD,EAAK,iBAAL,CAAZ,CAAA;EACAyC,IAAAA,OAAO,GAAG1C,CAAC,CAACC,EAAD,EAAK,gBAAL,CAAX,CAAA;MACA0C,OAAO,GAAG3C,CAAC,CAACC,EAAD,EAAK,gBAAL,CAAX,CAvBoB;;MA0BpBA,EAAE,CAACgB,WAAH,GAAiBD,IAAjB,CAAA;KA1BF,CAAA;;EA6BA,EAAA,IAAMwI,IAAI,GAAG,SAAPA,IAAO,GAAM;MACjBF,OAAO,EAAA,CAAA;EACP,IAAA,IAAI,CAACrJ,EAAD,IAAO,CAACc,QAAZ,EAAsB,OAAA;;MACtB,IAAIG,MAAM,CAACgB,MAAX,EAAmB;QACjByC,YAAY,EAAA,CAAA;EACb,KAAA;;MACD,IAAIzD,MAAM,CAACiB,SAAX,EAAsB;QACpB+C,eAAe,EAAA,CAAA;EAChB,KAAA;;MACD,IAAIhE,MAAM,CAACO,WAAX,EAAwB;EACtB,MAAA,IAAI,OAAOP,MAAM,CAACO,WAAd,KAA8B,QAAlC,EAA4C;EAC1CxB,QAAAA,EAAE,CAAC8E,SAAH,CAAaC,GAAb,CAAyC9D,uBAAAA,GAAAA,MAAM,CAACO,WAAhD,CAAA,CAAA;EACD,OAFD,MAEO;EACLxB,QAAAA,EAAE,CAAC8E,SAAH,CAAaC,GAAb,CAAiB,sBAAjB,CAAA,CAAA;EACD,OAAA;EACF,KAAA;;EACD,IAAA,IAAIhF,CAAC,CAACC,EAAD,EAAK,wBAAL,CAAL,EAAqC;EACnCkF,MAAAA,iBAAiB,CAAC;EAAEG,QAAAA,WAAW,EAAE,IAAA;EAAf,OAAD,CAAjB,CAAA;EACD,KAAA;;EACDlB,IAAAA,GAAG,CAACS,QAAD,EAAW,OAAX,EAAoBqE,eAApB,CAAH,CAAA;EACA9E,IAAAA,GAAG,CAACrD,QAAD,EAAW,aAAX,EAA0BoH,cAA1B,CAAH,CAAA;EACA/D,IAAAA,GAAG,CAACrD,QAAD,EAAW,cAAX,EAA2BoH,cAA3B,CAAH,CAAA;EACA/D,IAAAA,GAAG,CAACrD,QAAD,EAAW,aAAX,EAA0B2H,aAA1B,CAAH,CAAA;EACAtE,IAAAA,GAAG,CAACrD,QAAD,EAAW,WAAX,EAAwByH,WAAxB,CAAH,CAAA;EACApE,IAAAA,GAAG,CAACrD,QAAD,EAAW,cAAX,EAA2BiI,cAA3B,CAAH,CAAA;EACA5E,IAAAA,GAAG,CAACrD,QAAD,EAAW,WAAX,EAAwBiI,cAAxB,CAAH,CAAA;EACA5E,IAAAA,GAAG,CAACrD,QAAD,EAAW,oBAAX,EAAiCiI,cAAjC,CAAH,CAAA;;MAEA,IAAI9H,MAAM,CAACC,YAAX,EAAyB;QACvB+G,QAAQ,EAAA,CAAA;QACRvB,WAAW,EAAA,CAAA;EACZ,KAAA;KA/BH,CAAA;;EAkCA,EAAA,IAAM8C,OAAO,GAAG,SAAVA,OAAU,GAAM;MACpBzI,IAAI,CAACuB,SAAL,GAAiB,IAAjB,CAAA;MACAmH,oBAAoB,CAACtG,YAAD,CAApB,CAAA;EACAqB,IAAAA,IAAI,CAACI,QAAD,EAAW,OAAX,EAAoBqE,eAApB,CAAJ,CAAA;EACAzE,IAAAA,IAAI,CAAC1D,QAAD,EAAW,aAAX,EAA0BoH,cAA1B,CAAJ,CAAA;EACA1D,IAAAA,IAAI,CAAC1D,QAAD,EAAW,cAAX,EAA2BoH,cAA3B,CAAJ,CAAA;EACA1D,IAAAA,IAAI,CAAC1D,QAAD,EAAW,aAAX,EAA0B2H,aAA1B,CAAJ,CAAA;EACAjE,IAAAA,IAAI,CAAC1D,QAAD,EAAW,WAAX,EAAwByH,WAAxB,CAAJ,CAAA;EACA/D,IAAAA,IAAI,CAAC1D,QAAD,EAAW,cAAX,EAA2BiI,cAA3B,CAAJ,CAAA;EACAvE,IAAAA,IAAI,CAAC1D,QAAD,EAAW,WAAX,EAAwBiI,cAAxB,CAAJ,CAAA;MACAvE,IAAI,CAAC1D,QAAD,EAAW,oBAAX,EAAiCiI,cAAjC,CAAJ,CAVoB;;MAYpB,OAAO/I,EAAE,CAACgB,WAAV,CAAA;KAZF,CAAA;;IAeAD,IAAI,CAACyI,OAAL,GAAeA,OAAf,CAAA;EAEAD,EAAAA,IAAI,GAvcgC;;EA0cpC,EAAA,OAAOxI,IAAP,CAAA;EACD;;;;;;;;"}